########################################################################################################
#Library functions
library(adegenet)
library(car)
library(diveRsity)
library(ggplot2)
library(ggpubr)
library(ggsignif)
library(tidyr)
library(hierfstat)
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("quercus_allcheck_orig_results.Rdata")
quercus_allcheck_orig_results.Rdata
final_quercus_results
final_alleles_all_quercus
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("quercus_allcheck_orig_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
save(minSize, file="min_samp_size.Rdata")
minSize
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("quercus_final_results.Rdata")
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("quercus_allcheck_altern_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("quercus_final_results.Rdata")
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
save(minSize, file="min_samp_size.Rdata")
minSize
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
minSize
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
minSize
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
MinSize
minSize
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("quercus_allcheck_altern_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Alternative\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
save(minSize, file="min_samp_size.Rdata")
minSize
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("quercus_allcheck_orig_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Allele_lim_change\\Original\\R-scripts")
load("combined_quercus_final.Rdata")
num_species = 14
#Loop to get the minimum sample size required to capture 95% of the alleles
#in 'wild' populations for each species
#averaging each row, which represents all 1000 replicates (so we are averaging across replicates)
minSize = vector(length=num_species)
for(i in 1:num_species) {
minSize[i] = (min(which(rowMeans(final_quercus_results[,,i])>0.95)))
}
save(minSize, file="min_samp_size.Rdata")
minSize
