########################################################################################################
#Library functions
library(adegenet)
library(car)
library(diveRsity)
library(ggplot2)
library(ggpubr)
library(ggsignif)
library(tidyr)
library(hierfstat)
#FLAGS
#file conversion flag
#set to true once files have been converted once
#false if you want to convert files
conversion_flag = TRUE
#Fst flag
#Fst code adds a lot of time to run the code
#so if you don't want to run it, keep Fst off by setting it FALSE
fst_flag = TRUE
#allele category flag
#this flag allows code that runs the allele category code to be turned on
#when the flag is set to TRUE
allele_cat_flag = FALSE
#Set working directory to the path that contains the folder of all of your simulation files
mydir = "C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\Simulations"
setwd(mydir)
#creating a list of the species we have simulated
species_list = c("\\q_acerifolia",
"\\q_arkansana",
"\\q_austrina",
"\\q_boyntonii",
"\\q_carmenensis",
"\\q_cedrosensis",
"\\q_engelmannii",
"\\q_georgiana",
"\\q_graciliformis",
"\\q_havardii",
"\\q_hinckleyii",
"\\q_oglethorpensis",
"\\q_pacifica",
"\\q_tomentella")
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R_scripts")
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R_scripts")
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
#Loading in results from all_quercus_sampling.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("quercus_final_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("quercus_final_results.Rdata")
#vector of species names
species_names = c("Q. acerifolia", "Q. arksanana", "Q. austrina", "Q. boyntonnii", "Q. carmenensis", "Q. cedrosensis", "Q. engelmannii", "Q. georgiana",
"Q. graciliformis", "Q. havardii", "Q. hinckleyii", "Q. oglethorpensis", "Q. pacifica", "Q. tomentella")
#varaible to hold sample range
num_sampled = (1:500)
#varaible to hold column names for dataframe
col_names = c("avg_prop_all", "num_sampled")
#saves a list of all newly processed dataframes. The list contains separate dataframes for each species
combined_quercus_list = list()
#data processing loop
for(i in 1:length(species_names)) {
temp_data_frame = as.data.frame(final_quercus_results[,,i]) #creating a temporary data frame to hold the current
temp_data_frame = rowMeans(temp_data_frame) #taking means of simulation replicates for a cleaner plot
temp_data_frame = as.data.frame(temp_data_frame) # rowMeans takes it out of dataframe format so converting back to dataframe
temp_data_frame$num_sampled = num_sampled #defining a column of the sample size
colnames(temp_data_frame) = col_names #setting the column names
species = rep(species_names[i], 500) #creating a new column with the species names
temp_data_frame$species = species #setting the new columns values
combined_quercus_list[[i]] = temp_data_frame
}
#using rbind() to vertically bind all dataframes to one large dataframe, so that all species can be plotted
#on the same graph in all_quercus_plotting.R
combined_quercus_new = do.call(rbind, combined_quercus_list)
#saving the combined dataframe in .Rdata file
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
save(combined_quercus_new, file="combined_quercus_final.Rdata")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
#################################################################################################
#Library functions
library(dplyr)
#Loading in results from all_quercus_sampling.R for alternative simulations
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("quercus_final_results.Rdata")
tail(final_quercus_results[1])
tail(final_quercus_results[,,1])
tail(final_quercus_results[1,,1])
########################################################################################################
#Library functions
library(adegenet)
library(car)
library(diveRsity)
library(ggplot2)
library(ggpubr)
library(ggsignif)
library(tidyr)
library(hierfstat)
citation("hierfstat")
####################################################################################################
#library functions
library(ggplot2)
#load in data from all_quercus_processing.R
setwd("C:\\Users\\kayle\\Documents\\Quercus_IUCN_samp_sims\\Alternative_simulations\\R-scripts")
load("combined_quercus_final.Rdata")
#plot containing all oak species
#number sampled on x axis
#proportion of alleles on y axis
#
ggplot(data=combined_quercus_new, aes(x=num_sampled, y=avg_prop_all, color=species)) +
geom_line(size=1,aes(linetype=species)) +
scale_linetype_manual(values=c("solid", "dotted", "longdash", "solid", "twodash", "dotted", "solid", "longdash", "solid", "dotdash", "solid", "dotted", "solid", "longdash")) +
ylim(0.7,1) +
xlim(0,400) +
ggtitle("Genetic diversity captured for varying sample sizes across 14 oak species") +
xlab("Number of unique individuals sampled") +
ylab("Proportion of alleles captured") +
labs(fill = "Species") +
theme(text = element_text(size=15)) +
theme_bw() #white background
